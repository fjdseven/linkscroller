;(function(e,t,n,r){var i={options:{linkSelector:"a",linkEvent:"click",linkDataAttr:"data-anchor",onBeforeAnim:-1,onAfterAnim:-1},__STATE_EVENT__:"statechange",_create:function(){var t=this;t.el=e(t.element);t.initLinkHandlers();t._initStateChange()},_initStateChange:function(){var n=this;var r=function(e){return"#"+e.split(/\//).pop()};var i=function(){var t=History.getState(),i=r(t.hash),s=e(i);if(i==="#label")return false;var o=s.offset().top-50;if(n.options.onBeforeAnim!==-1){n.options.onBeforeAnim(n.el)}e("html, body").animate({scrollTop:o},function(){if(n.options.onAfterAnim!==-1){n.options.onAfterAnime(n.el)}})};History.Adapter.bind(t,n.__STATE_EVENT__,function(){i()})},initLinkHandlers:function(){var n=this;n.el.on(n.options.linkEvent,n.options.linkSelector,function(t){var r=e(this).attr(n.options.linkDataAttr);History.pushState({},"",r);t.preventDefault()});var r=[];n.el.find(n.options.linkSelector).each(function(t,i){i=e(i);var s=i.attr(n.options.linkDataAttr);var o="#"+s;r.push({offsTop:e(o).offset().top,label:s})});var i;e(t).scroll(function(){clearTimeout(i);i=setTimeout(function(){var t=e("body").scrollTop(),n=-1,i="",s=-1;for(var o=0,u=r.length;o<u;o++){var a=r[o],f=Math.abs(a.offsTop-t);if(f===0){i=a.label;s=o;break}else if(f<n){n=f;s=o}else n=f}if(s==-1)s=0;if(History.getState().hash==="/"+r[s].label)return false;History.replaceState({},"",r[s].label)},500)})},destroy:function(){e.Widget.prototype.destroy.call(this)}};e.widget("tk.linkscroll",i)})(jQuery,window,document)
